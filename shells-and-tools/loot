#!/bin/bash

CTFNAME=bandit
SYSTEM=$CTFNAME.labs.overthewire.org
PORT=2220
USER=$1 
USERID=`echo $USER | cut -b 7-`
NEXTID=$CTFNAME$(( $USERID+1 ))

echo "Logging into $SYSTEM:$PORT as $USER to get loot..."

PASSFILE=$CTFNAME.txt

echo "Password for $USER is" 
grep $USER $PASSFILE | cut -d ":" -f 2

scp -r -P $PORT $USER@$SYSTEM:/tmp/$NEXTID.txt /tmp/
echo Going hunting for $NEXTID.txt
NEXTPASS=`cat /tmp/$NEXTID.txt`
while true; do
	read -p "Does $NEXTID:$NEXTPASS look like new loot?" yn
	case $yn in
		[Yy]* ) echo $NEXTID:$NEXTPASS >> $CTFNAME.txt; exit;;
		[Nn]* ) echo Alrighty.; exit;;
		* ) echo "Yes or no, man?";;
	esac
done

